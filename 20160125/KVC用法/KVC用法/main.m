//
//  main.m
//  KVC用法
//
//  Created by qingyun on 16/1/25.
//  Copyright © 2016年 qingyun. All rights reserved.
//

#import <Foundation/Foundation.h>

#import "Student.h"
#import "Person.h"

#define NAME @"name"

int main(int argc, const char * argv[]) {
    @autoreleasepool {
        
        // 1 KVC的核心方法
        Student *st = [Student new];
        [st setValue:@"凯辉" forKey:@"name"]; // 设置
        NSLog(@"name >>>> %@", [st valueForKey:@"name"]); // 获取
        
        // 2 keypath
        Person *p = [Person new];
        p.name = @"yuchao";
        
        st.friend = p;
        st.friend.name = @"马宇超";
        NSLog(@"friend >>>> %@", st.friend.name);
        NSLog(@"friend >>>> %@", [st valueForKeyPath:@"friend.name"]);
        [st setValue:@20 forKeyPath:@"friend.age"]; // imba 自动拆箱数值
        NSLog(@"friend >>>> %d", st.friend.age);
        
        Student *st1 = [Student new];
        [st1 setValue:@"陈建" forKeyPath:@"friend.name"]; // ⚠️⚠️⚠️ 在访问键路径时一定要保证路径中间的对象是存在的
        NSLog(@"name >>>> %@", [st1 valueForKeyPath:@"friend.name"]);
        
        // 3 穿透只读 和 私有
        [st1 setValue:[NSDate dateWithTimeIntervalSinceNow:-(86400*365*30)] forKey:@"birthday"];
        NSLog(@"st1.birth >>>> %@", st1.birthday);
        
        [st1 setValue:@10000 forKey:@"money"];
        NSLog(@"st1.money >>>> %@", [st1 valueForKey:@"money"]);
        
        // 4 未定义的键
        //??? 如何避免键路径写错
        // 4.1 宏
        [st1 setValue:@"dongdong" forKey:NAME];
        // 4.2 处理undefinedkey
        [st setValue:@"chengdu" forKey:@"xingming"];
        NSLog(@"name >>>> %@", [st valueForKey:@"name"]);
        NSLog(@"name >>>> %@", [st valueForKey:@"username"]);
        
        // 5 自动拆箱中的nil value处理
        [st1 setValue:0 forKey:@"age"];
        
        // 6 批处理
        NSLog(@"values >>> %@", [st valuesForKeys:@[@"xingming",@"height",@"age",@"money"]]);
        // 灌入所有属性值
        [st setValuesForKeysWithDictionary:@{@"name":@"ziqi",@"age":@20}];
        
        // 7 整体操作
        Person *jike = [[Person alloc] initWithName:@"jike"];
        Person *longxiang = [[Person alloc] initWithName:@"longxiang"];
        Person *jiawang = [[Person alloc] initWithName:@"jiawang"];
        Person *yameng = [[Person alloc] initWithName:@"yameng"];
        
        [st.friends addObjectsFromArray:@[jike, longxiang,jiawang, yameng]];
        
        NSLog(@"friends >>>> %@", [st valueForKeyPath:@"friends.name"]);
        
        [st setValue:@10000 forKeyPath:@"friends.money"];
        NSLog(@"friends >>>> %@", [st valueForKeyPath:@"friends.money"]);
        
        
    }
    return 0;
}




































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































